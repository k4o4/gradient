<!DOCTYPE html>
<html>
<head>
	<title>Gradient</title>
</head>
<body>

<label>Original Color:</label><input type="color" name="color1" id="cp" value="#142feb">
<input type="text" name="RGBcolor" id="RGBcolor">
<div id="originalColor"></div><br>
<br><br>

<div id="colorBar"></div>

<div id="fakeLabel">
	<div id="labelText">Chat with us, we are online!</div>
	<svg xmlns="http://www.w3.org/2000/svg" width="22" height="33" viewBox="0 0 22 33">
    <path fill="#18c139" fill-rule="evenodd" d="M0-.018c12.635 3.131 22 14.546 22 28.15v4.886C9.365 29.887 0 18.472 0 4.868V-.017z"></path>
</svg>

</div>


<script type="text/javascript">
	var cp = document.getElementById('cp');
	var cb = document.getElementById('colorBar');
	var oc = document.getElementById('originalColor');
	var textColor = document.getElementById('RGBcolor'); 
	var fl = document.getElementById('fakeLabel'); 
	var leftColor;
	var rightColor;

	var hueL = 0;
	var saturationL = 10;
	var lightnessL = 10;

	var hueR = 0;
	var saturationR = -10;
	var lightnessR = -10;


	drawGradient();
	cp.addEventListener('change', drawGradient);
	textColor.addEventListener('change', function(){
		cp.value = textColor.value;
		drawGradient();
	});

	function drawGradient() {
		leftColor = rgbToHex(hslToRgb(increaseSaturation(increaseLightness(rgbToHsl(cp.value), 'L'), 'L')));
		rightColor = rgbToHex(hslToRgb(increaseSaturation(increaseLightness(rgbToHsl(cp.value), 'R'), 'R')));
		gradient = 'linear-gradient(to right bottom, ' + leftColor + ' 20%, ' + rightColor + ' 80%)';
		console.log(gradient);
		textColor.value = cp.value;
		oc.style.background = cp.value;
		cb.style.background = gradient;
		fl.style.background = gradient;
		if(window['jivo_api']) jivo_api.setWidgetColor(leftColor, rightColor);
	}

	function increaseHue(hsl, position) {
		//hsl[0] += window['hue' + position]/100;
		return hsl;
	}	

	function increaseSaturation(hsl, position) {
		hsl[1] += window['saturation' + position]/100;
		return hsl;
	}	

	function increaseLightness(hsl, position) {
		hsl[2] += window['lightness' + position]/100;
		return hsl;
	}


	function rgbToHsl(rgb) {
		r = parseInt(rgb[1] + rgb[2], 16);
		g = parseInt(rgb[3] + rgb[4], 16);
		b = parseInt(rgb[5] + rgb[6], 16);

		r /= 255, g /= 255, b /= 255;

		var max = Math.max(r, g, b), min = Math.min(r, g, b);
		var h, s, l = (max + min) / 2;

		if (max == min) {
			h = s = 0; // achromatic
		} else {
			var d = max - min;
			s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

			switch (max) {
				case r: h = (g - b) / d + (g < b ? 6 : 0); break;
				case g: h = (b - r) / d + 2; break;
				case b: h = (r - g) / d + 4; break;
			}

			h /= 6;
		}

		return [ h, s, l ];
	}

	function hslToRgb(hsl) {
		h = hsl[0];
		s = hsl[1];
		l = hsl[2];
		var r, g, b;

		if (s == 0) {
			r = g = b = l; // achromatic
		} else {
			function hue2rgb(p, q, t) {
				if (t < 0) t += 1;
				if (t > 1) t -= 1;
				if (t < 1/6) return p + (q - p) * 6 * t;
				if (t < 1/2) return q;
				if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
				return p;
			}

			var q = l < 0.5 ? l * (1 + s) : l + s - l * s;
			var p = 2 * l - q;

			r = hue2rgb(p, q, h + 1/3);
			g = hue2rgb(p, q, h);
			b = hue2rgb(p, q, h - 1/3);
		}

		return [ r * 255, g * 255, b * 255 ];
	}

	function rgbToHex(rgb) {
		var r = toHex(rgb[0]);
		var g = toHex(rgb[1]);
		var b = toHex(rgb[2]);
		console.log('#' + r + g + b);
		return('#' + r + g + b);

	}

	function toHex(n) {
	    n = parseInt(n, 10);
	    if (isNaN(n)) return '00';
	    n = Math.max(0, Math.min(n, 255));
	    return '0123456789ABCDEF'.charAt((n - n % 16) / 16) + '0123456789ABCDEF'.charAt(n % 16);
	}

	jivo_onLoadCallback = function() {
		jivo_api.showProactiveInvitation('Hello! How may I help you?');
		drawGradient();
	}


</script>
<style type="text/css">
	#colorBar {
		width: 100%;
		height: 200px;
	}
	#originalColor {
		display: inline-block;
		height: 30px;
		margin-left: 20px;
		position: relative;
		top: 17px;
		width: 300px;
	}
	#fakeLabel {
		border-top-left-radius: 8px;
		border-top-right-radius: 28px;
		box-shadow: 0 12px 14px 8px rgba(0, 0, 0, 0.17);
		height: 40px;
		margin: auto;
		position: relative;
		top: 100px;
		width: 325px;
	}
	#fakeLabel > svg {
		margin-left: 303px;
	}
	#labelText {
		color: #fff;
		font-family: Arial;
		font-size: 15px;
		margin: 10px 37px auto 16px;
		position: absolute;

	}
	jdiv[style^="position: fixed;"] {
		display: none;
	}
</style>

<!-- BEGIN JIVOSITE CODE {literal} -->
<script type='text/javascript'>
(function(){ var widget_id = 'h7BIDQFFnu';var d=document;var w=window;function l(){var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;s.src = '//code.aprv2.dev.jivosite.com/script/widget/'+widget_id; var ss = document.getElementsByTagName('script')[0]; ss.parentNode.insertBefore(s, ss);}if(d.readyState=='complete'){l();}else{if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})();
</script>
<!-- {/literal} END JIVOSITE CODE -->





</body>
</html>
